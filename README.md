<h1>Expamine alerts, logs and rules with Suricata  </h1>


<h2>Description</h2>
In thia lab I explored suricata alerts and logs, including the general process of rule creation.
 
The Suricata tool monitors network interfaces and applies rules to the packets that pass through the interface. Suricata determines whether each packet should generate an alert and be dropped, rejected, or allowed to pass through the interface.

Source and destination networks must be specified in the Suricata configuration. Custom rules can be written to specify which traffic should be processed.

<h2>Task 1. Examin a custom rule in Suricata<h2>
  
  The <i>/home/analyst</i> directory contains a <i>custom.rules</i> file that defines the network traffic rules, which Suricata captures.

In this task, I explored the composition of the Suricata rule defined in the <i>custom.rules</i> file. <br>

<img src="https://github.com/Bridgetanntighe/Filter-SQL-II/assets/134883216/bdfda8d9-0f8e-4787-b7c9-f8951fd6a6be" height="90%" width="90%" alt="Active Directory Lab"/><br>
The <i>less</i> command can also be used to read file content one page at a time, making it useful for reading lengthy output.<br>

<img src="https://github.com/Bridgetanntighe/Filter-SQL-II/assets/134883216/e59a20af-5a74-44cc-aec1-927656230cb4" height="70%" width="70%" alt="Active Directory Lab"/><br>

The <b>action</b> is the first part of the signature. It determines the action to take if all conditions are met.<br>

<h2>Task 2.Trigger a custom rule in Suricata  </h2>

<img src="https://github.com/Bridgetanntighe/Filter-SQL-II/assets/134883216/fdb13e1e-c6d7-4473-8f43-ee73cc2c3841" height="90%" width="90%" alt="Active Directory Lab"/><br>
Before running Suricata, there are no files in the <i>/var/log/suricata</i> directory. <br>
After starting the Suricata application and processes the <i>sample.pcap</i> file uses the rules in the <i>custom.rules</i> file. It returns an output stating how many packets were processed by Suricata.<br>
The <i>-r sample.pcap</i> option specifies an input file to mimic network traffic. In this case, the <i>sample.pcap</i> file.<br>
The <i>-S custom.rules</i> option instructs Suricata to use the rules defined in the <i>custom.rules</i> file.<br>
The <i>-k none</i> option instructs Suricata to disable all checksum checks.<br>
<b>Checksums</b> are a way to detect if a packet has been modified in transit. Because I used network traffic from a sample packet capture file, I won't need Suricata to check the integrity of the checksum.<br>
Suricata adds a new alert line to the <i>/var/log/suricata/fast.log</i> file when all the conditions in any of the rules are met.<br>
<br>
Below I then listed the files in the <i>/var/log/suricata</i> folder again:<br>
<img src="https://github.com/Bridgetanntighe/Filter-SQL-II/assets/134883216/debe8797-1b17-4aa0-bbff-f2e0d6f9e54f" height="80%" width="80%" alt="Active Directory Lab"/><br>
After running Suricata, there are now four files in the <i>/var/log/suricata</i> directory, including the <i>fast.log</i> and <i>eve.json</i> files.<br>
<br>
Lets examine these files in more detail:<br>
<img src="https://github.com/Bridgetanntighe/Filter-SQL-II/assets/134883216/7b9565ae-4d24-4a32-bf76-62973b24cb7b" height="90%" width="90%" alt="Active Directory Lab"/><br>
Each line or entry in the <i>fast.log</i> file corresponds to an alert generated by Suricata when it processes a packet that meets the conditions of an alert generating rule. Each alert line includes the message that identifies the rule that triggered the alert, as well as the source, destination, and direction of the traffic.<br>


<h2>Task 3. Examine eve.json output</h2>
The IP address 142.250.1.139 is displayed in the expanded Answers section for the DNS query for opensource.google.com.
<img src="https://github.com/Bridgetanntighe/FilterSQLTheory/assets/134883216/e240ad3a-0a09-4e60-9c7c-d67b512c4afe" height="80%" width="80%" alt="Active Directory Lab"/>

<h2>Conclusion</h2>
This filters to packets containing web requests made with the <i>curl</i> command in this sample packet capture file.
<img src="https://github.com/Bridgetanntighe/FilterSQLTheory/assets/134883216/bfec4b33-2cb7-44f4-9885-78f89ff4d444 height="80%" width="80%" alt="Active Directory Lab"/>
